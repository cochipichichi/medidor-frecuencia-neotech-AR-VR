<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Medidor de Frecuencia â€” Neotech EduLab v2</title>
  <link rel="stylesheet" href="style.css" />
  <meta name="theme-color" content="#0f172a" />
</head>
<body class="theme-dark">
  <header class="topbar">
    <div class="logo">ğŸ›ï¸ Frecuencia Neotech</div>
    <nav class="controls">
      <button id="btn-home" title="Inicio">ğŸ </button>
      <button id="btn-voz" title="Leer frecuencia">ğŸ—£ï¸</button>
      <button id="btn-theme" title="Tema claro/oscuro">ğŸŒ“</button>
      <button id="btn-plus" title="Aumentar texto">A+</button>
      <button id="btn-minus" title="Disminuir texto">Aâˆ’</button>
      <button id="btn-lang" title="Cambiar idioma">ğŸŒ</button>
      <button id="btn-focus" title="Modo atenciÃ³n">ğŸ§ </button>
      <button id="btn-search" title="Buscar">ğŸ”</button>
    </nav>
  </header>

  <main class="container">
    <section class="panel">
      <h1 data-i18n="title">ğŸ“¡ Medidor de frecuencia (2D + 3D)</h1>
      <p data-i18n="subtitle">Selector de micrÃ³fono, rango ajustable, nota musical, 3D local, historial y exportaciÃ³n.</p>
      <div class="btn-row">
        <button id="btn-start" class="primary" data-i18n="start">ğŸ™ï¸ Iniciar mediciÃ³n</button>
        <button id="btn-stop" class="secondary" disabled data-i18n="stop">â¹ï¸ Detener</button>
        <button id="btn-freeze" class="secondary" disabled>ğŸ§Š Congelar mÃ¡x.</button>
        <button id="btn-pause" class="secondary" disabled>â¸ï¸ Pausar</button>
        <button id="btn-export" class="csv" disabled>ğŸ“¤ Exportar CSV</button>
        <button id="btn-mode" class="secondary">ğŸ‘¨â€ğŸ« Modo docente</button>
        <button id="btn-toggle-3d" class="secondary">ğŸ§± 3D ON/OFF</button>
      </div>
      <div class="device-row">
        <label for="inputDevice">ğŸ¤ Mic:</label>
        <select id="inputDevice"></select>

        <label for="rangeMode">ğŸ“ Rango:</label>
        <select id="rangeMode">
          <option value="voice">Voz (80â€“1200 Hz)</option>
          <option value="music" selected>Instrumentos (50â€“4000 Hz)</option>
          <option value="full">Completo</option>
        </select>

        <label for="perfMode">âš™ï¸ Rend:</label>
        <select id="perfMode">
          <option value="high">Alto</option>
          <option value="medium" selected>Medio</option>
          <option value="low">Bajo</option>
        </select>
      </div>

      <div class="level-row">
        <span>ğŸ”Š Nivel de entrada:</span>
        <div class="level-bar">
          <div id="level-fill"></div>
        </div>
        <span id="level-text">-- dB</span>
      </div>
    </section>

    <section class="freq-wrapper" id="lab-panel">
      <div class="freq-display current">
        <span>Frecuencia actual:</span>
        <div id="freq-value">-- Hz</div>
        <div id="note-value" class="note-value">--</div>
      </div>
      <div class="freq-display max">
        <span>Frecuencia mÃ¡xima:</span>
        <div id="freq-max">-- Hz</div>
      </div>
      <div class="freq-display current">
        <span>Muestras:</span>
        <div id="freq-samples">0</div>
      </div>
    </section>

    <section class="panel collapsible">
      <button id="help-toggle" class="help-toggle">â“ Â¿QuÃ© estoy viendo?</button>
      <div id="help-content" class="help-content">
        <p>Este sitio mide el sonido del micrÃ³fono en tiempo real, detecta la frecuencia mÃ¡s fuerte (en Hz), la muestra arriba y dibuja el espectro en 2D y 3D. AdemÃ¡s estima la nota musical mÃ¡s cercana y te deja exportar los datos.</p>
      </div>
    </section>

    <section class="graph-card">
      <h2>ğŸ“ˆ Espectro 2D</h2>
      <canvas id="freqCanvas" width="900" height="220"></canvas>
    </section>

    <section class="graph-card" id="card-3d">
      <h2>ğŸ§Š Espectro 3D en tiempo real
    <div class="xr-inline-buttons">
      <button id="inline-ar" class="xr-inline ar">ğŸ“± AR</button>
      <button id="inline-vr" class="xr-inline vr">ğŸ¥½ VR</button>
    </div></h2>
      <div id="scene3d" class="scene3d">
        <span id="scene3d-fallback" class="fallback">Cargando 3Dâ€¦ (verifica /libs)</span>
      </div>
    </section>

    <section class="history-card" id="history-card">
      <h2>ğŸ•’ Historial reciente</h2>
      <table>
        <thead><tr><th>#</th><th>ms</th><th>Hz</th><th>Hz mÃ¡x.</th><th>Nota</th></tr></thead>
        <tbody id="history-body"></tbody>
      </table>
    </section>
  </main>

  <div class="search-overlay" id="search-overlay">
    <div class="search-box">
      <input type="text" id="search-input" placeholder="Buscar en la pÃ¡gina..." />
      <button id="search-close">Cerrar</button>
    </div>
  </div>

  <footer class="footer">
    <p>ğŸ“šÂ© Neotech EduLab â€” EducaciÃ³n Inmersiva<br/>ğŸ› ï¸Prohibida su copia y/o reproducciÃ³n</p>
  </footer>

  <script src="./libs/three.min.js"></script>
  <script src="./libs/OrbitControls.js"></script>
  <script src="app.js"></script>
</body>
</html>
